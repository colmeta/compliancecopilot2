name: Keep Backend Alive

on:
  schedule:
    # Run every 5 minutes to prevent Render hibernation (12 times per hour)
    # Render hibernates after 15 minutes, so 5 min ensures we're always ahead
    - cron: '*/5 * * * *'
  workflow_dispatch:  # Allow manual trigger from GitHub Actions UI

jobs:
  ping-backend:
    runs-on: ubuntu-latest
    timeout-minutes: 2
    
    steps:
      - name: Ping Backend Health Endpoint
        run: |
          echo "ğŸ”„ Pinging CLARITY backend to prevent hibernation..."
          curl -f -s -m 30 https://veritas-faxh.onrender.com/health || exit 1
          echo "âœ… Backend is alive!"
        
      - name: Ping Instant Endpoint (Optional)
        continue-on-error: true
        run: |
          echo "ğŸ”„ Pinging instant endpoint..."
          curl -f -s -m 30 https://veritas-faxh.onrender.com/instant/health || echo "âš ï¸ Instant endpoint not available"
        
      - name: Ping Real AI Endpoint (Optional)
        continue-on-error: true
        run: |
          echo "ğŸ”„ Pinging real AI endpoint..."
          curl -f -s -m 30 https://veritas-faxh.onrender.com/real/health || echo "âš ï¸ Real AI endpoint not available"

